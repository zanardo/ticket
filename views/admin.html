%rebase base title="Administrar", filter="", username=username, userisadmin=userisadmin, version=version

<h2>Usuários</h2>
<form method="post" action="/admin/save-new-user" enctype="multipart/form-data">
	<input type="text" name="username" size="30">
	<input type="submit" name="submit" value="novo usuário">
</form>
<p>
<table>
	<th>usuário</th><th>nome</th><th>e-mail</th><th>administrador</th><th>ações</th>
	%for user in users:
		<tr>
			<td> {{user['username']}} </td>
			<td> {{user['name']}} </td>
			<td> {{user['email']}} </td>
			<td>
				%if user['is_admin']:
					sim
				%else:
					não
				%end
			</td>
			<td>
				<a href="/admin/edit-user/{{user['username']}}">editar</a> 
				%if username != user['username']:
					<a href="/admin/remove-user/{{user['username']}}">excluir</a>
					<a href="/admin/force-new-password/{{user['username']}}">forçar nova senha</a>
					%if user['is_admin']:
						<a href="/admin/change-user-admin-status/{{user['username']}}/0">retirar admin</a>
					%else:
						<a href="/admin/change-user-admin-status/{{user['username']}}/1">tornar admin</a>
					%end
				%end
			</td>
		</tr>
	%end
</table>

<h2>Funcionalidades ativas</h2>
<form method="post" action="/admin/save-features" enctype="multipart/form-data">
	<input type="checkbox" name="features" {{ "checked=1" if "timetrack" in features else "" }} value="timetrack">Cronômetro de tempo
	<br>
	<input type="checkbox" name="features" {{ "checked=1" if "adminonly" in features else "" }} value="adminonly">Restrição de tickets para administradores
	<br>
	<input type="checkbox" name="features" {{ "checked=1" if "fileattach" in features else "" }} value="fileattach">Arquivos anexos
	<p>

	<input type="submit" name="submit" value="salvar funcionalidades">
</form>

<h2>Configurações</h2>
<form method="post" action="/admin/save-config" enctype="multipart/form-data">
	<input type="text" size="40" name="mail.smtp" value="{{ config['mail.smtp'] }}">
	<tt>mail.smtp</tt> (Servidor SMTP para envio de e-mail)
	<p>

	<input type="text" size="40" name="file.maxsize" value="{{ config['file.maxsize'] }}">
	<tt>file.maxsize</tt> (Tamanho máximo em bytes de arquivos anexos)
	<p>

	<input type="submit" name="submit" value="salvar configurações">
</form>

<h2>Manutenção</h2>
<a href="/admin/reindex-fts">Recria índices de busca</a>: Utilizar
caso você tenha modificado dados diretamente no banco de dados (exemplo: importação de dados
de outros sistemas ou após atualizações de versão que exijam esta rotina).